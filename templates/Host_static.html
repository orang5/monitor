{% extends '__base__.html' %}
{% load staticfiles %}
{% block content-wrapper %}
      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            主机
            <small>version1.0</small>
          </h1>
          <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> 主页</a></li>
            <li class="active">虚拟化平台</li>
            <li class="active">主机1</li>
          </ol>
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="row">
           <div class="col-md-12">
            <div class="box">
              <div class="box-header with-border">
                <h3 class="box-title">实时状态</h3>
              </div>
              <div class="box-body">
                <div class="row">
                     <div class="col-md-3">
                        <div class="box box-primary">
                          <div class="box-header with-border">
                            <i class="fa fa-bar-chart-o"></i>
                            <h3 class="box-title">Cpu利用率</h3>
                            <div class="box-tools pull-right">
                              Real time
                              
                              <div class="btn-group" id="cpu_realtime" data-toggle="btn-toggle">
                                <button type="button" class="btn btn-default btn-xs active" data-toggle="on">On</button>
                                <button type="button" class="btn btn-default btn-xs" data-toggle="off">Off</button>
                              </div>
                              <div class="btn-group" id="device_cpu">
                                <button class="btn btn-xs dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bars"></i></button>
                                <ul class="dropdown-menu pull-right" role="menu">
                                {% if vmInfo.summary_config_name %}
                                    <li data-toggle="id__cpu"> <a>{{ vmInfo.summary_hardware_cpuModel }}</a></li>
                                {% else %}
                                  {% for item in vmInfo.cpu %}
                                    <li data-toggle="{{ item.DeviceID }}"> <a>{{ item.value.caption }}</a></li>
                                  {% endfor %}
                                {% endif %}

                                </ul>
                              </div>
                            </div>
                          </div>
                          <div class="box-body">
                            <div id="cpu-chart" style="height: 200px;" class="full-width-chart"></div>
                          </div><!-- /.box-body-->
                        </div><!-- /.box -->
                      </div><!-- /.col -->
                    
                     <div class="col-md-3">
                        <!-- memery chart -->
                        <div class="box box-primary">
                          <div class="box-header with-border">
                            <i class="fa fa-bar-chart-o"></i>
                            <h3 class="box-title">内存用量</h3>
                            <div class="box-tools pull-right">
                              Real time
                              <div class="btn-group" id="mem_realtime" data-toggle="btn-toggle">
                                <button type="button" class="btn btn-default btn-xs active" data-toggle="on">On</button>
                                <button type="button" class="btn btn-default btn-xs" data-toggle="off">Off</button>
                              </div>
                              <div class="btn-group" id="device_mem">
                                <button class="btn btn-xs dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bars"></i></button>
                                <ul class="dropdown-menu pull-right" role="menu">
                                {% if vmInfo.summary_config_name %}
                                    <li data-toggle="id__mem"> <a> 内存用量</a></li>
                                {% else %}
                                  <li data-toggle="SysMemory"> <a> 内存用量</a></li>
                                {% endif %}
                                </ul>
                              </div>
                            </div>
                          </div>
                          <div class="box-body">
                            <div id="mem-chart" style="height: 200px;" class="full-width-chart"></div>
                          </div><!-- /.box-body-->
                        </div><!-- /.box -->
                      </div><!-- /.col -->
                     
                     <div class="col-md-3">
                        <!-- memery chart -->
                        <div class="box box-primary">
                          <div class="box-header with-border">
                            <i class="fa fa-bar-chart-o"></i>
                            <h3 class="box-title">网络流量</h3>
                            <div class="box-tools pull-right">
                              Real time
                              <div class="btn-group" id="net_realtime" data-toggle="btn-toggle">
                                <button type="button" class="btn btn-default btn-xs active" data-toggle="on">On</button>
                                <button type="button" class="btn btn-default btn-xs" data-toggle="off">Off</button>
                              </div>
                              <div class="btn-group" id="device_net">
                                <button class="btn btn-xs dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bars"></i></button>
                                <ul class="dropdown-menu pull-right" role="menu">
                                {% if vmInfo.summary_config_name %}
                                    <li data-toggle="id__net"> <a> 发送流量</a></li>
                                {% else %}
                                  {% for item in vmInfo.network %}
                                  <li data-toggle="{{ item.DeviceID }}"> <a>{{ item.value.caption }}</a></li>
                                  {% endfor %}
                                {% endif %}                                
                                </ul>
                              </div>
                            </div>
                          </div>
                          <div class="box-body">
                            <div id="net-chart" style="height: 200px;" class="full-width-chart"></div>
                          </div><!-- /.box-body-->
                        </div><!-- /.box -->
                      </div><!-- /.col -->
                    
                     <div class="col-md-3">
                        <!-- memery chart -->
                        <div class="box box-primary">
                          <div class="box-header with-border">
                            <i class="fa fa-bar-chart-o"></i>
                            <h3 class="box-title">磁盘IO</h3>
                            <div class="box-tools pull-right">
                              Real time
                              <div class="btn-group" id="disk_realtime" data-toggle="btn-toggle">
                                <button type="button" class="btn btn-default btn-xs active" data-toggle="on">On</button>
                                <button type="button" class="btn btn-default btn-xs" data-toggle="off">Off</button>
                              </div>
                              <div class="btn-group" id="device_disk">
                                <button class="btn btn-xs dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bars"></i></button>
                                <ul class="dropdown-menu pull-right" role="menu">
                                {% if vmInfo.summary_config_name %}
                                    <li data-toggle="id__disk"> <a> 磁盘写操作</a></li>
                                {% else %}
                                 {% for item in vmInfo.logical_disk %}
                                  <li data-toggle="{{ item.DeviceID }}"> <a>{{ item.value.caption }}</a></li>
                                 {% endfor %}
                                {% endif %}    

                                 
                                </ul>
                              </div>
                            </div>
                          </div>
                          <div class="box-body">
                            <div id="disk-chart" style="height: 200px;" class="full-width-chart"></div>
                          </div><!-- /.box-body-->
                        </div><!-- /.box -->
                      </div><!-- /.col -->
                      
               </div><!-- /.row -->
               
              </div><!-- /.box-body-->
            </div><!-- /.box -->
          </div><!-- /.col -->
         </div><!-- /.row -->

           <div class="row">
            <div class="col-xs-5">
              <div class="box">
                <div class="box-header">
                  <h3 class="box-title">详细属性</h3>
                </div><!-- /.box-header -->
                <div class="box-body">
                {{vmInfo}}
                  <table id="example2" class="table table-bordered table-hover">
                    <tbody>
                    <tr>
                      <td>主机名: {{ vmInfo.host_info.hostname }} {{ vmInfo.summary_config_name }}</td>
                      <td>操作系统: {{ vmInfo.host_info.os }} {{ vmInfo.summary_config_product_osType }}</td>
                    </tr>
                     {% if vmInfo.summary_config_name %}
                     
                     <tr>
                        <td>Cpu型号: {{ vmInfo.summary_hardware_cpuModel }}</td>
                        <td>核心数:  {{ vmInfo.summary_hardware_numCpuCores }}</td>
                     </tr>
                     <tr>
                        <td>Cpu最大速度: {{ vmInfo.summary_hardware_cpuMhz }}</td>
                        <td>服务器型号: {{ vmInfo.summary_hardware_model }} </td>
                     </tr>
                     <tr>
                        <td>内存容量: {% widthratio vmInfo.summary_hardware_memorySize 1048576 1 %} MB</td>
                        <td>内存已分配: {{ vmInfo.summary_quickStats_overallMemoryUsage }} MB</td>
                     </tr>
                      <tr>
                        <td>网卡数量: {{ vmInfo.summary_hardware_numNics }}</td>
                        <td>允许虚拟机迁移: {{ vmInfo.summary_config_vmotionEnabled }}</td>
                     </tr>
                     {% else %}
                     
                    {% for cpu in vmInfo.host_info.cpu %}
                     <tr>
                        <td>Cpu型号: {{ cpu.caption }} </td>
                        <td>核心数: {{ cpu.NumberOfCores }} </td>
                     </tr>
                     <tr>
                        <td>Cpu最大速度: {{ cpu.MaxClockSpeed }} </td>
                        <td>逻辑处理器: {{ cpu.NumberOfLogicalProcessors }} </td>
                     </tr>
                     {% endfor %}
                     {% for mem in vmInfo.host_info.mem %}
                      <tr>
                        <td>内存型号: {{ mem.Name }}</td>
                        <td>总容量: {{ mem.Capacity }} GB</td>
                     </tr>
                     {% endfor %}
                     {%for nic in vmInfo.host_info.nic %}
                    <tr>
                        <td>适配器名称: {{ nic.caption }}</td>
                        <td>Mac: {{nic.mac}}</td>
                     </tr>
                     <tr>
                        <td>IP: {{ vmInfo.host_info.ip.0 }}</td>
                        <td>子网掩码： {{ nic.subnet_mask.0 }}/{{ nic.subnet_mask.1 }}</td>
                     </tr>
                     <tr>
                        {% for gateway in nic.gateway %}
                        <td>网关：{{gateway}}</td>
                        {% endfor %}
                     </tr>
                     {% endfor %}
                     {% endif %}
                     
                     <!--
                     <tr>
                        <td>磁盘容量: 466GB</td>
                        <td>文件系统：NTFS</td>
                     </tr>
                       <tr>
                        <td>磁盘平均相应时间: 4.3毫秒</td>
                        <td>磁盘活动时间: 6%</td>
                     </tr>
                     -->
                    </tbody>
                  </table>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
            </div><!-- /.col -->          

            <div class="col-xs-7">            
              <div class="box">
                <div class="box-header">
                  <h3 class="box-title">虚拟机列表</h3>
                </div><!-- /.box-header -->
                <div class="box-body">
                 {{ vmList }}
                  <table id="example2" class="table table-bordered table-hover">
                    <thead>
                      <tr>
                        <th>名称</th>
                        <th>类型</th>                        
                        <th>MAC / UUID</th>
                      </tr>
                    </thead>
                    <tbody>
                    {% for vm in vmList %}
                      <tr>
                          <td> <a href="/VirtualMachine_static/?uuid={{ vm.uuid}}" > {{ vm.mo }} </a> </td>
                          <td> {% if vm.is_template %} 模板 {% else %} 虚拟机 {% endif %} </td>
                          <td> {% if vm.is_template %}
                                  n/a
                               {% else %}
                                 {{ vm.uuid }}
                               {% endif %}</td>                          
                      </tr>
                    {%endfor%}
                    </tbody>
                  </table>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
              
              
              
            </div><!-- /.col -->
            
          </div><!-- /.row -->
 
            <div class="row">
            <div class="col-xs-12">
              <div class="box">
                <div class="box-header">
                  <h3 class="box-title">日志</h3>
                </div><!-- /.box-header -->
                <div class="box-body">
                <!--{{  event }} -->
                  <table id="example2" class="table table-bordered table-hover">
                    <thead>
                      <tr>
                        <th>时间</th>
                        <th>消息类型</th>
                        <th>事件</th>
                        <th>UUID</th>
                      </tr>
                    </thead>
                    <tbody>
                    {% for evt in event %}
                       <tr>
                        <td> {{ evt.timestamp}} </td>
                        <td> {{ evt.name}} </td>
                        <td> {{ evt.value}} </td>
                        <td> <a href='/Host_static/?uuid={{ evt.uuid }}'>{{ evt.uuid}} </a> </td>
                      </tr>  
                    {%endfor%} 
                    </tbody>
                  </table>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
            </div><!-- /.col -->
          </div><!-- /.row -->
        </section><!-- /.content -->
        
        

     </div><!-- /.content-wrapper -->
    {% endblock %}
   {% block script %}
      <script src="{% static "plugins/flot/jquery.flot.min.js" %}"></script>
      <script src="{% static "plugins/flot/jquery.flot.resize.min.js" %}"></script>
      <script src="{% static "plugins/flot/jquery.flot.pie.min.js" %}"></script>
      <script src="{% static "plugins/flot/jquery.flot.categories.min.js" %}"></script>
      <script src="{% static "js/pages/virtual_machine.js" %}"></script>
    {% endblock %} 